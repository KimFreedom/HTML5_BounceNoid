<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>BounceNoid HTML5 Phaser</title>
	<style>
		* { padding: 0; margin: 0; }
	</style>
	<script src="//cdn.jsdelivr.net/npm/phaser@3.0.0/dist/phaser.min.js"></script>
</head>
<body>
<script>
	var gameConfig = {
		type: Phaser.AUTO,
		width: 1000,
		height: 1000,
		physics: {
			default: 'arcade'
		},
		scene: {
			preload: preload,
			create: create
		},
        scale: {
            mode: Phaser.FIT
        }
	};
	var game = new Phaser.Game(gameConfig);
	
	function preload ()
    {
        //this.load.setBaseURL('http://labs.phaser.io');
        this.load.image('sky', 'assets/skies/NightSky.png');
        //this.load.image('logo', 'assets/sprites/GreenBall.png');
        this.load.spritesheet('blocks', 'assets/sprites/blocks.png', { frameWidth: 32, frameHeight: 32 });
        this.load.image('ball', 'assets/sprites/ball.png');
        this.load.image('red', 'assets/particles/redParticle.png');

        this.canvas = this.sys.game.canvas;
    }
    function create ()
    {
        let { width, height } = this.canvas;
        
        /*
        let borderConfig = {
            x: 0,
            y: 50,
            width: width,
            height: height - 100,
            checkLeft: true,
            checkright: true,
            checktop: true,
            checkbottom: true
        };
        */
        //this.physics.world.setBounds(borderConfig);
        //this.Phaser.Physics.Arcade.World.setBounds(borderConfig);
        //this.Phaser.Physics.Matter.World.setBounds(borderConfig);
        this.physics.world.bounds.y = 50;
        this.physics.world.bounds.height = height - 100;
        

        this.add.image(width / 2, height / 2, 'sky');
        /*
        blocks = this.physics.add.group({
            key: 'block',
            repeat: 4,
            setXY: { x: width / 6, y: height / 5, stepX: width / 6 }
        });
        */
        this.blockGroup = this.add.group({
            key: 'blocks',
            frame: [0, 1, 2, 3, 4],
            frameQuantity: 60
        });

        Phaser.Actions.GridAlign(this.blockGroup.getChildren(), {
            width: 20,
            height: 15,
            cellWidth: 32,
            cellHeight: 32,
            x: 180,
            y: 240
        });
        
        /*
        var particles = this.add.particles('red');
        var emitter = particles.createEmitter({
            speed: 100,
            scale: { start: 1, end: 0 },
            blendMode: 'ADD'
        });
        */

        this.ball = this.physics.add.image(400, 100, 'ball');
        this.ball.setVelocity(100, 200);
        this.ball.setBounce(1);
        this.ball.setCollideWorldBounds(true);
        this.ball.onWorldBounds = true;

        this.physics.add.collider(this.ball, this.blockGroup, this.hitBallAndBlock);
        //this.physics.add.collider(this.ball, this.blockGroup, this.hitBallAndBlock, null, this);
        //this.physics.add.collider(this.ball, this.blockGroup);

        //emitter.startFollow(ball);
    }

    function hitBallAndBlock(ball, block) {
        // TODO
        console.log('Hit!');
    };
</script>
</body>
</html>